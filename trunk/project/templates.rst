Общие шаблоны проекта
=====================

* ``base.html`` - базовый шаблон всего сайта.
* ``index.html`` - шаблон всего сайта, кроме шагов заказа билетов (наследует базовый шаблон всего сайта ``base.html``).
* ``counters.html`` - счётчики **Яндекс.Метрика**, **Google.Analytics**, **UpToLike**, пиксель **вКонтакте**.
* ``share_help.html`` - блок с кнопками *"Поделиться"* от сервиса **UpToLike** и блок *"Справки и бронирование"* с контактными телефонами.

Идентификаторы счётчиков и контактные телефоны берутся из JSON-настроек сайта ``settings`` в модели ``bezantrakta.location.models.Domain``.

* ``error.html`` - шаблон отдельной страницы с информацией об ошибке, НЕ наследующий базовый шаблон ``base.html`` (пустая страница с текстом в центре).
* ``400.html`` - стандартный шаблон для ошибки ``400``.
* ``403.html`` - стандартный шаблон для ошибки ``403``.
* ``404.html`` - стандартный шаблон для ошибки ``404``.
* ``500.html`` - стандартный шаблон для ошибки ``500``.

Выбор города
------------
Клиентская логика для выбора городов находится в шаблоне ``cities.js``.

Выбранный пользователем город запоминается в **cookies**.

Если при заходе на сайт город ЕЩЁ НЕ был сохранён в **cookies** в браузере пользователя - окрывается всплывающее окно для выбора города. При нажатии на иконку какого-либо **активного города** псевдоним этого города запоминается в **cookies**. Активный город - город со статусом *"включен"* (``state=STATE_ENABLED`` в модели ``bezantrakta.location.models.City``).

После этого:

* если пользователь открывает на сайте другого города любую страницу, КРОМЕ шагов заказа билетов - происходит редирект на такую же страницу на "основном" сайте выбранного города - сайт, псевдоним (поддомен) которого совпадает с псевдонимом города.
* если пользователь открывает любую страницу в рамках процесса заказа билетов - редирект не происходит.
