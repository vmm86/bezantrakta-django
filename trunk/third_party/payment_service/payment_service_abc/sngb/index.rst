##################
СургутНефтеГазБанк
##################

********************
Запросы и ответы API
********************

Создание оплаты (init)
======================

URL: https://ecm.sngb.ru/ECommerce/PaymentInitServlet

Метод - *POST*.

+--------------+----------------------------------+--------------------------------------+
| название     | пример                           | описание                             |
+==============+==================================+======================================+
| **merchant** | 1001                             | Идентификатор мерчанта               |
+--------------+----------------------------------+--------------------------------------+
| **terminal** | 1001-alias                       | Алиас идентификатора терминала       |
+--------------+----------------------------------+--------------------------------------+
| **action**   |                                  | Код транзакции                       |
+--------------+----------------------------------+--------------------------------------+
|              | 1                                | *Purchase* - полная покупка          |
+--------------+----------------------------------+--------------------------------------+
|              | 4                                | *Authorization* - только авторизация |
+--------------+----------------------------------+--------------------------------------+
| **amt**      | 100                              | Сумма операции                       |
+--------------+----------------------------------+--------------------------------------+
| **trackid**  | 1368592109                       | Уникальный идентификатор заказа      |
+--------------+----------------------------------+--------------------------------------+
| **udf5**     | 5f4dcc3b5aa765d61d8327deb882cf99 | Хэш для аутентификации запроса       |
+----------------------------------------------------------------------------------------+
| Пользовательские поля                                                                  |
+----------------------------------------------------------------------------------------+
| **udf1**     | текст до 255 символов без специсмволов |                                |
+--------------+----------------------------------------+--------------------------------+
| **udf2**     | ``:{ ~`!@#$%^=+|\\:'\«»,/& }``         |                                |
+--------------+----------------------------------------+--------------------------------+
| **udf3**     |                                        |                                |
+--------------+----------------------------------------+--------------------------------+
| **udf4**     |                                        |                                |
+--------------+----------------------------------------+--------------------------------+

В пользовательских полях можно передавать любую информацию (за конкретным полем закрепляется какая-то важная для заказа сущность, которую затем можно получить в ответе на **URL Init Notification**).

При успешной инициализации заказа в ответ приходит URL платёжной формы **HostedPaymentPage** с необходимыми параметрами, например, ``https://ecm.sngb.ru/Gateway/hppaction?formAction=com.aciworldwide.commerce.gateway.payment.action.HostedPaymentPageAction&PaymentID=4841976051232680``.

В случае ошибки (если платёжная среда недоступна или запрос не аутентифицирован) возвращается **URL Error**, указанный в личном кабинете мерчанта, например, ``http://MyOnlineShop/Error?error=CGW00001&errortext=ErrorDescription``.

Управление транзакциями (tran)
==============================

URL: https://ecm.sngb.ru/ECommerce/PaymentTranServlet

Метод - *POST*.

Этот метод требуется только в случае постадийной оплаты и для обычной оплаты не нужен.

.. autoclass:: third_party.payment_service.payment_service_abc.sngb.api.SurgutNefteGazBank
