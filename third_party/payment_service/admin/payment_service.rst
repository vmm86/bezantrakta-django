.. _payment_service:

###########################
Сервисы онлайн-оплаты (СОО)
###########################

**********
Список СОО
**********

Фильтры
=======

* текстовый поиск по названию СОО

Действия
========

* добавить новый СОО

Действия с выбранными СОО
=========================

* удалить
* пересоздать кэш

Столбцы в таблице СОО
=====================

* **Название**
* **Идентификатор**
* **Работает** - включен ли СОО или нет.
* **Оплата настоящими деньгами** - оплата настоящими деньгами или тестовая оплата.

***************************
Страница редактирования СОО
***************************

Атрибуты СОО
============

* **Название**

* **Идентификатор** в латиннице.

  Рекомендуется соблюдать единообразие в названиях СОО - ``СОО-сайт``, например, ``sberbank-vrn`` или ``sngb-sur``.

* **Работает** - включен ли СОО или нет.

* **Оплата настоящими деньгами** - оплата настоящими деньгами или тестовая оплата:

  * Если включено - оплата настоящими деньгами.
  * Если отключено - тестовая оплата НЕнастоящими деньгами.

Настройки СОО в JSON
--------------------

* ``init`` { словарь 'ключ': 'значение' } - параметры для подключения (зависят от конкретного сервиса онлайн-оплаты):

  * Параметры для Сбербанк:

    * ``user`` строка - имя пользователя API.
    * ``test_pswd`` строка - пароль для тестовой оплаты.
    * ``prod_pswd`` строка - пароль для настоящей оплаты.

  * Параметры дляСургутНефтеГазБанк:

    * ``host`` строка - базовый URL для отправки запросов к API.
    * ``test_merchant_id`` число - идентификатор мерчанта для тестовой оплаты.
    * ``test_terminal_alias`` строка - алиас терминала для тестовой оплаты.
    * ``test_psk`` строка - cекретный ключ аутентификации запросов для тестовой оплаты.
    * ``test_token`` строка - токен для тестовой оплаты.
    * ``prod_merchant_id`` число - идентификатор мерчанта для настоящей оплаты.
    * ``prod_terminal_alias`` строка - алиас терминала для настоящей оплаты.
    * ``prod_psk`` строка - cекретный ключ аутентификации запросов для настоящей оплаты.
    * ``prod_token`` строка - токен для настоящей оплаты.

* ``commission`` число - комиссия сервиса онлайн-оплаты. Дробное число указывается через точку, например, ``2.8``. Если комиссия равна ``0`` - она НЕ прибавляется к общей сумме заказа.

* ``timeout`` число - время сессии на оплату заказа в минутах (по умолчанию - ``15``).

.. only:: dev

  ******
  Модели
  ******

  .. autoclass:: third_party.payment_service.models.payment_service.PaymentService
