#################
Настройки проекта
#################
Настройки проекта находятся в пакете ``project.settings`` и разбиты на несколько модулей.

Шаблоны настроек ``development``, ``staging`` и ``production``-окружения находятся в отдельных файлах. При первоначальном запуске проекта один из 3-х файлов указанных шаблонов берётся за основу, переименовывается в ``settings`` и помещается на 2 уровня выше пакета ``project.settings``. Возможные последующие правки настроек делаются в файле настроек проекта и добавляются в одном из 3-х шаблонов настроек в системе контроля версий.

Сам файл с настройками проекта в текущем окружении ``project.settings.settings`` (скопированный при первоначальном разворачивании проекта из соот. заготовки файла настроек) **является символьной ссылкой на 3 уровня выше**. Это сделано для удобного разворачивания новых версий проекта, чотбы файл с настройками находится ВНЕ папкипроекта и не затрагивается при очередном обновлении.

Получение настроек при работе проекта происходит следующим образом:

* Сначала в файле натсроек импортируется всё из базовых настроек проекта, НЕспецифичных для конкретного типа окружения (**development**, **staging**, **production**) и хранящихся в модуле ``base``,
* Затем указываются специфичные настройки для конкретного окружения,
* После этого импортируется всё из модуля с настройками логнирования в модуле ``logging``.

Кастомные параметры в файлах настроек:

* ``BEZANTRAKTA_PROJECT_VERSION`` (str): Текущая версия проекта.
* ``BEZANTRAKTA_IS_SECURE`` (bool): Настроен ли сайт для работы по HTTPS (от этого параметра зависит, что будет подставлятьяя при генерации абсолютных ссылок в проекте - ``http://`` или ``https://``)
* ``BEZANTRAKTA_ADMIN_URL`` (str): Кастомный адрес для входа в админ-панель вместо стандартного ``admin`` (требование безопасности).
* ``BEZANTRAKTA_COOKIE_WATCHER_TITLE`` и ``BEZANTRAKTA_COOKIE_WATCHER_VALUE`` (str): Имя и значение cookie, при наличии которой в браузере в его консоли в production выводятся диагностические сообщения ``console.log`` (по умолчанию в production в консоли браузера не выводится ничего в целях безопасности).
* ``BEZANTRAKTA_CATEGORY_ALL_TITLE`` (str): Название и псевдоним категории событий "**Все события**" (она не хранится в БД, т.к. охватывает вообще все события, в том числе не привязанные к какой-либо категории).
* ``BEZANTRAKTA_ORDER_VIEWS`` (tuple): Представления в приложении ``order``, являющиеся шагами заказа билетов 1, 2 и 3. При их выполнении не должны работать процессоры контекста в приложении ``event``, которые работают только с событиями в базовом шаблоне.
* ``BEZANTRAKTA_ETICKET_PATH`` (str): Путь для сохранения электронных PDF-билетов.
* ``BEZANTRAKTA_SCHEME_ALLOWED_CONTENT`` (str): Динамически генерируемая строка, содержащая все шаблоны тегов (теги, классы, атрибуты, стили), разрешённые для добавления при редактировании схем залов/схем отдельных секторов. Всё, что не входит в этот перечень, будет вычищаться при сохранении по принципу "**Что не разрешено, то запрещено**". При модификации работы со схемами эти парамтеры следует держать в актуальном состоянии.

* ``ENVIRONMENT`` (dict): Удобный вывод типа рабочего окружения в админ-панели для суперадминистраторов в виде цветной панели вверху страницы:

  * :green:`development` - разработка;
  * :yellow:`staging` - проверка работы на тестовом окружении, идентичному production-окружению;
  * :red:`production` - готовое бизнес-приложение.

* ``BEZANTRAKTA_ROOT_DOMAIN`` (str): Корневой домен для всех сайтов.
* ``BEZANTRAKTA_ROOT_DOMAIN_SLUG`` (str): Псевдоним сайта, работающего на корневом домене (``vrn``).

* ``BEZANTRAKTA_DEFAULT_PROMOTER`` (str): Реквизиты организатора (промоутера) по умолчанию.
* ``BEZANTRAKTA_DEFAULT_SELLER_TITLE`` (str): Реквизиты продавца (агента) по умолчанию.
* ``BEZANTRAKTA_DEFAULT_MAX_SEATS_PER_ORDER`` (int): Максимальное количество билетов в одном заказе по умолчанию (``7``).
* ``BEZANTRAKTA_DEFAULT_HEARTBEAT_TIMEOUT`` (int): Таймаут в секундах по умолчанию на повтореный запрос списка свободных мест и списка цен на билеты в событии (``10``).

  .. todo:: Переименовать в ``BEZANTRAKTA_DEFAULT_SEATS_AND_PRICES_TIMEOUT``.

* ``BEZANTRAKTA_DEFAULT_SEAT_TIMEOUT`` (int): Таймаут в минутах по умолчанию на добавление места в ПР, по истечении которого место автоматически освобождается, если такой функционал предусмотрен в текущем СПБ (``15``).

  .. todo:: Переименовать в ``BEZANTRAKTA_DEFAULT_RESERVE_TIMEOUT``.

* ``BEZANTRAKTA_DEBUG_CONSOLE`` (bool): Условное логирование в консоль отладочной информации с помощью модуля ``project.shortcuts.debug_console``.

Секретный ключ ``SECRET_KEY``, без которого проект не запустится, при первом запуске генерируется случайным образом и записывается в модуль ``project.settings.simsim``, НЕ находящийся в системе контроля версий, а затем импортируется из него.

.. todo:: При желании можно перевести ``SECRET_KEY`` в переменную окружения, а также генерировать его случайным образом при каждом перезапуске сервера приложений.

****
base
****
Базовые настройки (общие для всех рабочих окружений).

***********************
settings_01_development
***********************
Шаблон настроек ``development``-окружения.

.. automodule:: project.settings.settings_01_development

*******************
settings_02_staging
*******************
Шаблон настроек ``staging``-окружения.

.. automodule:: project.settings.settings_02_staging

**********************
settings_03_production
**********************
Шаблон настроек ``production``-окружения.

.. automodule:: project.settings.settings_03_production

********
settings
********
Файл с актуальными настройками проекта в текущем окружении - символьная ссылка на 2 уровня выше. Сами актуальные настройки, таким образом, НЕ хранятся в системе контроля версий.

*******
logging
*******
Настройки логирования (общие для всех рабочих окружений).

.. automodule:: project.settings.logging

******
simsim
******
Секретный ключ ``SECRET_KEY``, файл которого генерируется автоматически и НЕ хранится в системе контроля версий.
