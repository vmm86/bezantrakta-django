#####################
Общие шаблоны проекта
#####################

* ``base.html`` - базовый шаблон сайта.
* ``index.html`` - основной шаблон всего сайта, кроме шагов заказа билетов, наследующий базовый шаблон ``base.html``. Шаблоны шагов заказа билетов раземещены в приложении ``order``.
* ``counters.html`` - шаблон для динимаческой генерации кода счётчиков **Яндекс.Метрика**, **Google.Analytics**, **UpToLike**, пикселей **Facebook** и **вКонтакте**. Идентификаторы счётчиков берутся из JSON-настроек сайта ``settings`` в модели ``bezantrakta.location.models.Domain``.
* ``share_help.html`` - шаблон блока с кнопками "**Поделиться**" от сервиса **UpToLike** и блока "**Справки и бронирование**" с контактными телефонами сайта. Кнтактные телефоны берутся из JSON-настроек сайта ``settings`` в модели ``bezantrakta.location.models.Domain``.
* ``error.html`` - шаблон страницы с информацией об ошибке, НЕ наследующий базовый шаблон ``base.html`` (пустая страница с текстом в центре).
* ``400.html`` - стандартный шаблон для ошибки **400**, наследующий базовый шаблон ``index.html``.
* ``403.html`` - стандартный шаблон для ошибки **403**, наследующий базовый шаблон ``index.html``.
* ``404.html`` - стандартный шаблон для ошибки **404**, наследующий базовый шаблон ``index.html``.
* ``500.html`` - стандартный шаблон для ошибки **500**, наследующий базовый шаблон ``index.html``.

********************
Логика выбора города
********************
Клиентская логика для выбора городов находится в шаблоне ``cities.js``.

Город, выбранный пользователем при клике на название города во всплывающем окне, запоминается в cookies.

Если при заходе на сайт город ЕЩЁ НЕ был выбран ранее и сохранён в cookies, окрывается всплывающее окно для выбора города. При нажатии на иконку какого-либо **активного города** (со статусом "**включен**") псевдоним этого города запоминается в cookies. После этого:

* если пользователь открывает на сайте другого города **любую страницу, КРОМЕ шагов заказа билетов** - происходит редирект на такую же страницу на "основном" сайте выбранного города - сайт, псевдоним (поддомен) которого совпадает с псевдонимом города.
* если пользователь открывает **любую страницу в рамках процесса заказа билетов** - редирект не происходит.
